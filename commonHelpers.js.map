{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["\nexport const createGalleryCardTemplate = pictureInfo => {\n  return `\n  <li class=\"gallery-card\">\n    <a class=\"gallery-link\" href=\"${pictureInfo.largeImageURL}\">\n      <img\n        class=\"gallery-img\"\n        src=\"${pictureInfo.webformatURL}\"\n        alt=\"${pictureInfo.tags}\"\n        />\n    </a>\n<div class=\"gallery-info\">\n    <div class=\"info-item\">\n      <strong>Likes</strong>\n      <span>${pictureInfo.likes}</span>\n    </div>\n    <div class=\"info-item\">\n      <strong>Views</strong>\n      <span>${pictureInfo.views}</span>\n    </div>\n    <div class=\"info-item\">\n      <strong>Comments</strong>\n      <span>${pictureInfo.comments}</span>\n    </div>\n    <div class=\"info-item\">\n      <strong>Downloads</strong>\n      <span>${pictureInfo.downloads}</span>\n    </div>\n  </div>\n  </li>\n  `;\n};\n","import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\nconst API_KEY = '45269069-80d5a565d51e24ea911778696';\n\nexport const fetchPhotos = (query, page) => {\n  // const searchParams = new URLSearchParams({\n  //   q: query,\n  //   key: API_KEY,\n  //   page: page,\n  //   per_page: 10,\n  //   image_type: 'photo',\n  //   orientation: 'horizontal',\n  //   safesearch: true,\n  // });\n  const searchParams = {\n    params: {\n      q: query,\n      key: API_KEY,\n      page: page,\n      per_page: 15,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n    },\n  };\n  return axios.get('/api/', searchParams);\n\n  // return fetch(`https://pixabay.com/api/?${searchParams}`).then(response => {\n  //   console.log(`https://pixabay.com/api/?${searchParams}`);\n  //   if (!response.ok) {\n  //     throw new Error(response.status);\n  //   }\n  //   return response.json();\n  // });\n};\n","import iziToast from \"izitoast\";\nimport SimpleLightbox from \"simplelightbox\";\n\nimport { createGalleryCardTemplate } from './js/render-functions.js';\nimport { fetchPhotos } from './js/pixabay-api.js';\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loaderEl = document.querySelector('.js-loader');\nconst loadMoreBtnEl = document.querySelector('.js-load-more');\n\nconst izitoastPosition = 'topRight';\nlet commonTotalHits = 0;\nlet currentPage = 1;\nlet searchedValue = '';\n\nlet lightbox =  new SimpleLightbox('.gallery a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n        })\n\nconst galleryCardHeight = () => {\n  const galleryCard = document.querySelector('.gallery-img');\n  if (galleryCard) {\n    return galleryCard.getBoundingClientRect().height;\n  }\n  return 0;\n}\n\n\nconst onLoadMoreBtnClick = async event => {\n  try {\n    if (commonTotalHits > 0 && commonTotalHits <= 15 * currentPage) {\n    iziToast.error({\n      message: 'Ми шкодуемо але всі пости закінчилися!',\n      position: izitoastPosition,\n    });\n    loadMoreBtnEl.classList.add('is-hidden');\n    return;\n    }\n    currentPage++;\n    const { data } = await fetchPhotos(searchedValue, currentPage);\n    const { hits } = data;\n    commonTotalHits = data.totalHits;\n    if (data.length === 0) {\n      loadMoreBtnEl.classList.add('is-hidden');\n    iziToast.error({\n      message: 'Постів більше не знайдено!',\n      position: izitoastPosition,\n    });\n      return;\n    }\n\n    const postCardsTemplate = hits\n      .map(imgInfo => createGalleryCardTemplate(imgInfo))\n      .join('');\n    galleryEl.insertAdjacentHTML('beforeend', postCardsTemplate);\n    lightbox.refresh();\n    const cardHeight = galleryCardHeight();\n    window.scrollBy({top: cardHeight * 2, behavior: 'smooth' });\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nconst onSearchFormSubmit = event => {\n  event.preventDefault();\n\n  searchedValue = event.target.elements.user_query.value.trim();\n  loadMoreBtnEl.classList.add('is-hidden');\n  if (searchedValue === '') {\n    iziToast.error({\n      message: 'Поле для пошуку не має бути порожнім!',\n      position: izitoastPosition,\n    });\n\n    searchFormEl.reset();\n    return;\n  }\n\n  loaderEl.classList.remove('is-hidden');\n  currentPage = 1;\n  fetchPhotos(searchedValue, currentPage)\n    .finally(() => {\n      loaderEl.classList.add('is-hidden');\n    })\n    .then(({ data }) => {\n      const { hits } = data;\n      if (hits.length === 0) {\n        iziToast.error({\n          message: 'За вашим запитом, зображень не знайдено!',\n          position: 'topRight',\n        });\n\n        searchFormEl.reset();\n        galleryEl.innerHTML = '';\n\n        return;\n      }\n      const galleryCardsTemplate = hits\n        .map(imgInfo => createGalleryCardTemplate(imgInfo))\n        .join('');\n\n      galleryEl.innerHTML = galleryCardsTemplate;\n      lightbox.refresh();\n    loadMoreBtnEl.classList.remove('is-hidden');\n    })\n    .catch(err => {\n      console.log(err);\n    });\n};\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtnEl.addEventListener('click', onLoadMoreBtnClick);"],"names":["createGalleryCardTemplate","pictureInfo","axios","API_KEY","fetchPhotos","query","page","searchParams","searchFormEl","galleryEl","loaderEl","loadMoreBtnEl","izitoastPosition","commonTotalHits","currentPage","searchedValue","lightbox","SimpleLightbox","galleryCardHeight","galleryCard","onLoadMoreBtnClick","event","iziToast","data","hits","postCardsTemplate","imgInfo","cardHeight","err","onSearchFormSubmit","galleryCardsTemplate"],"mappings":"owBACO,MAAMA,EAA4BC,GAChC;AAAA;AAAA,oCAE2BA,EAAY,aAAa;AAAA;AAAA;AAAA,eAG9CA,EAAY,YAAY;AAAA,eACxBA,EAAY,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAMjBA,EAAY,KAAK;AAAA;AAAA;AAAA;AAAA,cAIjBA,EAAY,KAAK;AAAA;AAAA;AAAA;AAAA,cAIjBA,EAAY,QAAQ;AAAA;AAAA;AAAA;AAAA,cAIpBA,EAAY,SAAS;AAAA;AAAA;AAAA;AAAA,ICxBnCC,EAAM,SAAS,QAAU,sBACzB,MAAMC,EAAU,qCAEHC,EAAc,CAACC,EAAOC,IAAS,CAU1C,MAAMC,EAAe,CACnB,OAAQ,CACN,EAAGF,EACH,IAAKF,EACL,KAAMG,EACN,SAAU,GACV,WAAY,QACZ,YAAa,aACb,WAAY,EACb,CACL,EACE,OAAOJ,EAAM,IAAI,QAASK,CAAY,CASxC,EC7BMC,EAAe,SAAS,cAAc,iBAAiB,EACvDC,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAW,SAAS,cAAc,YAAY,EAC9CC,EAAgB,SAAS,cAAc,eAAe,EAEtDC,EAAmB,WACzB,IAAIC,EAAkB,EAClBC,EAAc,EACdC,EAAgB,GAEhBC,EAAY,IAAIC,EAAe,aAAc,CACzC,aAAc,MACd,aAAc,GACtB,CAAS,EAET,MAAMC,EAAoB,IAAM,CAC9B,MAAMC,EAAc,SAAS,cAAc,cAAc,EACzD,OAAIA,EACKA,EAAY,sBAAuB,EAAC,OAEtC,CACT,EAGMC,EAAqB,MAAMC,GAAS,CACxC,GAAI,CACF,GAAIR,EAAkB,GAAKA,GAAmB,GAAKC,EAAa,CAChEQ,EAAS,MAAM,CACb,QAAS,yCACT,SAAUV,CAChB,CAAK,EACDD,EAAc,UAAU,IAAI,WAAW,EACvC,MACC,CACDG,IACA,KAAM,CAAE,KAAAS,CAAI,EAAK,MAAMnB,EAAYW,EAAeD,CAAW,EACvD,CAAE,KAAAU,CAAM,EAAGD,EAEjB,GADAV,EAAkBU,EAAK,UACnBA,EAAK,SAAW,EAAG,CACrBZ,EAAc,UAAU,IAAI,WAAW,EACzCW,EAAS,MAAM,CACb,QAAS,6BACT,SAAUV,CAChB,CAAK,EACC,MACD,CAED,MAAMa,EAAoBD,EACvB,IAAIE,GAAW1B,EAA0B0B,CAAO,CAAC,EACjD,KAAK,EAAE,EACVjB,EAAU,mBAAmB,YAAagB,CAAiB,EAC3DT,EAAS,QAAO,EAChB,MAAMW,EAAaT,IACnB,OAAO,SAAS,CAAC,IAAKS,EAAa,EAAG,SAAU,QAAQ,CAAE,CAC3D,OAAQC,EAAK,CACZ,QAAQ,IAAIA,CAAG,CAChB,CACH,EAEMC,EAAqBR,GAAS,CAKlC,GAJAA,EAAM,eAAc,EAEpBN,EAAgBM,EAAM,OAAO,SAAS,WAAW,MAAM,OACvDV,EAAc,UAAU,IAAI,WAAW,EACnCI,IAAkB,GAAI,CACxBO,EAAS,MAAM,CACb,QAAS,wCACT,SAAUV,CAChB,CAAK,EAEDJ,EAAa,MAAK,EAClB,MACD,CAEDE,EAAS,UAAU,OAAO,WAAW,EACrCI,EAAc,EACdV,EAAYW,EAAeD,CAAW,EACnC,QAAQ,IAAM,CACbJ,EAAS,UAAU,IAAI,WAAW,CACxC,CAAK,EACA,KAAK,CAAC,CAAE,KAAAa,KAAW,CAClB,KAAM,CAAE,KAAAC,CAAM,EAAGD,EACjB,GAAIC,EAAK,SAAW,EAAG,CACrBF,EAAS,MAAM,CACb,QAAS,2CACT,SAAU,UACpB,CAAS,EAEDd,EAAa,MAAK,EAClBC,EAAU,UAAY,GAEtB,MACD,CACD,MAAMqB,EAAuBN,EAC1B,IAAIE,GAAW1B,EAA0B0B,CAAO,CAAC,EACjD,KAAK,EAAE,EAEVjB,EAAU,UAAYqB,EACtBd,EAAS,QAAO,EAClBL,EAAc,UAAU,OAAO,WAAW,CAC9C,CAAK,EACA,MAAMiB,GAAO,CACZ,QAAQ,IAAIA,CAAG,CACrB,CAAK,CACL,EAEApB,EAAa,iBAAiB,SAAUqB,CAAkB,EAC1DlB,EAAc,iBAAiB,QAASS,CAAkB"}